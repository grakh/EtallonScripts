sel=activeDocument.selection;if (sel.length < 1) {alert("No select oject")} else{newLayer=activeDocument.layers;newLayer = activeDocument.layers.add();newLayer.zOrder(ZOrderMethod.BRINGTOFRONT);newLayer.name="Crop";const mm=72/25.4;const dline= 2*mm;for (i=0; i<app.activeDocument.swatches.length; i++) {    if (app.activeDocument.swatches[i].name == '[Ñîâìåùåíèå]' | app.activeDocument.swatches[i].name == '[Registration]') Registr = app.activeDocument.swatches[i].name;};LobjX=sel[0].position[0];LobjY=sel[0].position[1];RobjX=sel[0].position[0]+sel[0].width;RobjY=sel[0].position[1]-sel[0].height;for (i=1; i<sel.length; i++){if (LobjX>sel[i].position[0]) LobjX=sel[i].position[0];if (LobjY<sel[i].position[1]) LobjY=sel[i].position[1];if (RobjX<sel[i].position[0]+sel[i].width) RobjX=sel[i].position[0]+sel[i].width;if (RobjY>sel[i].position[1]-sel[i].height) RobjY=sel[i].position[1]-sel[i].height;}//alert(""+i);LeftCY=(LobjY+RobjY)/2;LeftCX=(LobjX+RobjX)/2;//alert(""+LeftCY);PWhite = new CMYKColor();PWhite .name = 'PWhite';PWhite .black =0; PWhite .cyan = 0; PWhite .magenta = 0; PWhite .yellow = 0;var triangleLeft= newLayer.groupItems.add();var triangleRight= newLayer.groupItems.add();var triangleGroup1 = triangleLeft.groupItems.add();var triangleGroup2 = triangleLeft.groupItems.add();var triangleGroup3 = triangleLeft.groupItems.add();//©Klimov S.V.ellipsesk  = triangleGroup1.pathItems.add();ellipsesk = triangleGroup1.pathItems.ellipse(0, 0, 0.29*mm, 0.29*mm, false, false );ellipsesk.stroked = true;ellipsesk.filled = true;ellipsesk.strokeWidth= 0.3*mm;ellipsesk.fillColor = PWhite;ellipsesk.strokeColor = PWhite;ellipses2 = triangleGroup1.pathItems.add();ellipses2 = triangleGroup1.pathItems.ellipse(0, 0, 0.29*mm, 0.29*mm, false, false );ellipses2.stroked = false;ellipses2.filled = true;ellipses2.fillColor = app.activeDocument.swatches[Registr].color;triangleGroup1.top = LobjY-(5*mm-0.35*mm);triangleGroup1.left = LobjX+(0.5*mm-0.35*mm);triangleGroup2=triangleGroup1.duplicate();triangleGroup2.top = LeftCY+0.35*mm;triangleGroup2.left = LobjX+(0.5*mm-0.35*mm);triangleGroup3=triangleGroup1.duplicate();triangleGroup3.top = RobjY + (5*mm+0.35*mm);triangleGroup3.left = LobjX+(0.5*mm-0.35*mm);triangleRight = triangleLeft.duplicate();triangleRight.left = RobjX-(0.5*mm+0.35*mm);//RobjX += 3*mm;//RobjY += 3*mm;//LobjY += 3*mm;//LobjX += 3*mm;const sm = mm;newCompoundPath1 = newLayer.compoundPathItems.add();newCompoundPath2 = newLayer.compoundPathItems.add();newCompoundPath3 = newLayer.compoundPathItems.add();newCompoundPath4 = newLayer.compoundPathItems.add();var triangleGroup = newLayer.groupItems.add();newCompoundPath1 = triangleGroup.compoundPathItems.add();newCompoundPath2 = triangleGroup.compoundPathItems.add();newCompoundPath3 = triangleGroup.compoundPathItems.add();newCompoundPath4 = triangleGroup.compoundPathItems.add();newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+dline, LobjY+dline), Array(RobjX, LobjY+dline) ) );newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+dline, LobjY+dline), Array(RobjX+dline, LobjY) ) );newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX-0.5*mm+dline, LobjY+dline-2.5*mm), Array(RobjX-0.5*mm, LobjY+dline-2.5*mm) ) );newPath1.stroked = true;newPath1.strokeWidth = 0.57;newPath1.strokeColor = app.activeDocument.swatches[Registr].color;newCompoundPath1.top += sm;newCompoundPath1.left += sm;newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-dline, LobjY+dline), Array(LobjX, LobjY+dline) ) );newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-dline, LobjY+dline), Array(LobjX-dline, LobjY) ) );newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-dline+0.5*mm, LobjY+dline-2.5*mm), Array(LobjX+0.5*mm, LobjY+dline-2.5*mm) ) );newPath2.stroked = true;newPath2.strokeWidth = 0.57;newPath2.strokeColor = app.activeDocument.swatches[Registr].color;newCompoundPath2.top += sm;newCompoundPath2.left -= sm;newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-dline, RobjY-dline), Array(LobjX, RobjY-dline) ) );newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-dline, RobjY-dline), Array(LobjX-dline, RobjY) ) );newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-dline+0.5*mm, RobjY-dline+2.5*mm), Array(LobjX+0.5*mm, RobjY-dline+2.5*mm) ) );newPath3.stroked = true;newPath3.strokeWidth = 0.57;newPath3.strokeColor = app.activeDocument.swatches[Registr].color;newCompoundPath3.top -= sm;newCompoundPath3.left -= sm;newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+dline, RobjY-dline), Array(RobjX, RobjY-dline) ) );newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+dline, RobjY-dline), Array(RobjX+dline, RobjY) ) );newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+dline-0.5*mm, RobjY-dline+2.5*mm), Array(RobjX-0.5*mm, RobjY-dline+2.5*mm) ) );newPath4.stroked = true;newPath4.strokeWidth = 0.57;newPath4.strokeColor = app.activeDocument.swatches[Registr].color;newCompoundPath4.top -= sm;newCompoundPath4.left += sm;var Da= new Date ();//Dat=Da.toLocaleString();var Data= String (''+Da.getDate() +'.'+ (Da.getMonth()+1)+'.'+  Da.getFullYear());TextC = app.activeDocument.name+"   "+Data+"   Z95";//alert(TextC);var textRef = newLayer.textFrames.add();textRef.contents = TextC;textRef.top = RobjY+mm;textRef.left = LobjX+3*mm;textRef.textRange.characterAttributes.size = 7;textRef.textRange.characterAttributes.fillColor =app.activeDocument.swatches[Registr].color;//triangleGroup.top = LobjY-mm;//triangleGroup.left = LobjX-5*mm;}