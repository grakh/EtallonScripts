doc = app.activeDocument;sel=activeDocument.selection;if (sel.length < 1) {alert("No select oject")} else{newLayer=activeDocument.layers;newLayer = activeDocument.layers.add();newLayer.zOrder(ZOrderMethod.BRINGTOFRONT);newLayer.name="Crop";LobjX=sel[0].position[0];LobjY=sel[0].position[1];RobjX=sel[0].position[0]+sel[0].width;RobjY=sel[0].position[1]-sel[0].height;for (i=1; i<sel.length; i++){if (LobjX>sel[i].position[0]) LobjX=sel[i].position[0];if (LobjY<sel[i].position[1]) LobjY=sel[i].position[1];if (RobjX<sel[i].position[0]+sel[i].width) RobjX=sel[i].position[0]+sel[i].width;if (RobjY>sel[i].position[1]-sel[i].height) RobjY=sel[i].position[1]-sel[i].height;}//alert(""+i);newGroup = newLayer.groupItems.add();for ( i = sel.length-1; i >= 0; i-- ) {newItem = sel[i].duplicate();newItem.moveToBeginning( newGroup );	}LeftCY=(LobjY+RobjY)/2;LeftCX=(LobjX+RobjX)/2;//alert(""+LeftCY);newCrestPath1 = newLayer.compoundPathItems.add();newCrestPath2 = newLayer.compoundPathItems.add();newCrestPath3 = newLayer.compoundPathItems.add();//©Klimov S.V.newCrestPath4 = newLayer.compoundPathItems.add();var triangleGroup1 = newLayer.groupItems.add();newCrestPath1 = triangleGroup1.compoundPathItems.add();newCrestPath2 = triangleGroup1.compoundPathItems.add();newCrestPath3 = triangleGroup1.compoundPathItems.add();newCrestPath4 = triangleGroup1.compoundPathItems.add();newCrest1 = newCrestPath1.pathItems.add();newCrest1.setEntirePath( Array( Array(LobjX-14.174, LeftCY), Array(LobjX-28.348, LeftCY) ) );newCrest1 = newCrestPath1.pathItems.add();newCrest1.setEntirePath( Array( Array(LobjX-21.261, LeftCY-7.087), Array(LobjX-21.261, LeftCY+7.087) ) );newCrest1.stroked = true;newCrest1.strokeWidth = 0.57;newCrest1.strokeColor = app.activeDocument.swatches['[Registration]'].color;newCrest2 = newCrestPath2.pathItems.add();newCrest2.setEntirePath( Array( Array(RobjX+14.174, LeftCY), Array(RobjX+28.348, LeftCY) ) );newCrest2 = newCrestPath2.pathItems.add();newCrest2.setEntirePath( Array( Array(RobjX+21.261, LeftCY-7.087), Array(RobjX+21.261, LeftCY+7.087) ) );newCrest2.stroked = true;newCrest2.strokeWidth = 0.57;newCrest2.strokeColor = app.activeDocument.swatches['[Registration]'].color;newCrest3 = newCrestPath3.pathItems.add();newCrest3.setEntirePath( Array( Array(LeftCX-7.087, LobjY+21.261), Array(LeftCX+7.087, LobjY+21.261) ) );newCrest3 = newCrestPath3.pathItems.add();newCrest3.setEntirePath( Array( Array(LeftCX, LobjY+14.174), Array(LeftCX, LobjY+28.348) ) );newCrest3.stroked = true;newCrest3.strokeWidth = 0.57;newCrest3.strokeColor = app.activeDocument.swatches['[Registration]'].color;newCrest4 = newCrestPath4.pathItems.add();newCrest4.setEntirePath( Array( Array(LeftCX-7.087, RobjY-21.261), Array(LeftCX+7.087, RobjY-21.261) ) );newCrest4 = newCrestPath4.pathItems.add();newCrest4.setEntirePath( Array( Array(LeftCX, RobjY-14.174), Array(LeftCX, RobjY-28.348) ) );newCrest4.stroked = true;newCrest4.strokeWidth = 0.57;newCrest4.strokeColor = app.activeDocument.swatches['[Registration]'].color;triangleGroup1.moveToBeginning( newGroup );//newCompoundPath1 = newLayer.compoundPathItems.add();newCompoundPath2 = newLayer.compoundPathItems.add();newCompoundPath3 = newLayer.compoundPathItems.add();newCompoundPath4 = newLayer.compoundPathItems.add();var triangleGroup = newLayer.groupItems.add();newCompoundPath1 = triangleGroup.compoundPathItems.add();newCompoundPath2 = triangleGroup.compoundPathItems.add();newCompoundPath3 = triangleGroup.compoundPathItems.add();newCompoundPath4 = triangleGroup.compoundPathItems.add();newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+42.522, LobjY+42.522), Array(RobjX+28.34, LobjY+42.522) ) );newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+42.522, LobjY+42.522), Array(RobjX+42.522, LobjY+28.34) ) );newPath1.stroked = true;newPath1.strokeWidth = 0.57;newPath1.strokeColor = app.activeDocument.swatches['[Registration]'].color;newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-42.522, LobjY+42.522), Array(LobjX-28.34, LobjY+42.522) ) );newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-42.522, LobjY+42.522), Array(LobjX-42.522, LobjY+28.34) ) );newPath2.stroked = true;newPath2.strokeWidth = 0.57;newPath2.strokeColor = app.activeDocument.swatches['[Registration]'].color;newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-42.522, RobjY-42.522), Array(LobjX-28.34, RobjY-42.522) ) );newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-42.522, RobjY-42.522), Array(LobjX-42.522, RobjY-28.34) ) );newPath3.stroked = true;newPath3.strokeWidth = 0.57;newPath3.strokeColor = app.activeDocument.swatches['[Registration]'].color;newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+42.522, RobjY-42.522), Array(RobjX+28.34, RobjY-42.522) ) );newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+42.522, RobjY-42.522), Array(RobjX+42.522, RobjY-28.34) ) );newPath4.stroked = true;newPath4.strokeWidth = 0.57;newPath4.strokeColor = app.activeDocument.swatches['[Registration]'].color;triangleGroup.moveToBeginning( newGroup );//docm = activeDocument.layers.length;//alert(""+docm);DLayer = activeDocument.layers;DLayer = doc.layers[0];for ( i = 0; i < docm; i++)	{//alert(""+i+' '+doc.layers[i].name);if (doc.layers[i].name == "Fartuk") 			{			DLayer = doc.layers[i];	//alert(""+i+' '+doc.layers[i].name);			}							}if (DLayer.name != "Fartuk") 	{			DLayer =activeDocument.layers.add();		DLayer.name="Fartuk";		DLayer.zOrder(ZOrderMethod.SENDTOBACK);		}//alert(""+i+' '+doc.layers[i].name);											newGroup1 = DLayer.groupItems.add();for ( i = sel.length-1; i >= 0; i-- ) {newItem1 = sel[i];newItem1.moveToBeginning( newGroup1 );	}	newCrestPath5 = newLayer.compoundPathItems.add();newCrestPath6 = newLayer.compoundPathItems.add();newCrestPath7 = newLayer.compoundPathItems.add();newCrestPath8 = newLayer.compoundPathItems.add();var triangleGroup2 = newLayer.groupItems.add();newCrestPath5 = triangleGroup2.compoundPathItems.add();newCrestPath6 = triangleGroup2.compoundPathItems.add();newCrestPath7 = triangleGroup2.compoundPathItems.add();newCrestPath8 = triangleGroup2.compoundPathItems.add();newCrest5 = newCrestPath5.pathItems.add();newCrest5.setEntirePath( Array( Array(LobjX+21.261, LeftCY), Array(LobjX-21.261*3, LeftCY) ) );newCrest5 = newCrestPath5.pathItems.add();newCrest5.setEntirePath( Array( Array(LobjX-21.261, LeftCY-7.087*6), Array(LobjX-21.261, LeftCY+7.087*6) ) );newCrest5.stroked = true;newCrest5.strokeWidth = 0.57;newCrest5.strokeColor = app.activeDocument.swatches['[Registration]'].color;newCrest6 = newCrestPath6.pathItems.add();newCrest6.setEntirePath( Array( Array(RobjX-21.261, LeftCY), Array(RobjX+21.261*3, LeftCY) ) );newCrest6 = newCrestPath6.pathItems.add();newCrest6.setEntirePath( Array( Array(RobjX+21.261, LeftCY-7.087*6), Array(RobjX+21.261, LeftCY+7.087*6) ) );newCrest6.stroked = true;newCrest6.strokeWidth = 0.57;newCrest6.strokeColor = app.activeDocument.swatches['[Registration]'].color;newCrest7 = newCrestPath7.pathItems.add();newCrest7.setEntirePath( Array( Array(LeftCX-7.087*6, LobjY+21.261), Array(LeftCX+7.087*6, LobjY+21.261) ) );newCrest7 = newCrestPath7.pathItems.add();newCrest7.setEntirePath( Array( Array(LeftCX, LobjY-21.261), Array(LeftCX, LobjY+21.261*3) ) );newCrest7.stroked = true;newCrest7.strokeWidth = 0.57;newCrest7.strokeColor = app.activeDocument.swatches['[Registration]'].color;newCrest8 = newCrestPath8.pathItems.add();newCrest8.setEntirePath( Array( Array(LeftCX-7.087*6, RobjY-21.261), Array(LeftCX+7.087*6, RobjY-21.261) ) );newCrest8 = newCrestPath8.pathItems.add();newCrest8.setEntirePath( Array( Array(LeftCX, RobjY+21.261), Array(LeftCX, RobjY-21.261*3) ) );newCrest8.stroked = true;newCrest8.strokeWidth = 0.57;newCrest8.strokeColor = app.activeDocument.swatches['[Registration]'].color;triangleGroup2.moveToBeginning( newGroup1 );//}