sel=activeDocument.selection;if (sel.length < 1) {alert("No select oject")} else{newLayer=activeDocument.layers;newLayer = activeDocument.layers.add();newLayer.zOrder(ZOrderMethod.BRINGTOFRONT);newLayer.name="Crop";for (i=0; i<app.activeDocument.swatches.length; i++) {    if (app.activeDocument.swatches[i].name == '[Ñîâìåùåíèå]' | app.activeDocument.swatches[i].name == '[Registration]') Registr = app.activeDocument.swatches[i].name;};LobjX=sel[0].position[0];LobjY=sel[0].position[1];RobjX=sel[0].position[0]+sel[0].width;RobjY=sel[0].position[1]-sel[0].height;for (i=1; i<sel.length; i++){if (LobjX>sel[i].position[0]) LobjX=sel[i].position[0];if (LobjY<sel[i].position[1]) LobjY=sel[i].position[1];if (RobjX<sel[i].position[0]+sel[i].width) RobjX=sel[i].position[0]+sel[i].width;if (RobjY>sel[i].position[1]-sel[i].height) RobjY=sel[i].position[1]-sel[i].height;}//alert(""+i);LeftCY=(LobjY+RobjY)/2;LeftCX=(LobjX+RobjX)/2;//alert(""+LeftCY);var triangleGroup1 = newLayer.groupItems.add();round1 = triangleGroup1.pathItems.add();round2 = triangleGroup1.pathItems.add();round3 = triangleGroup1.pathItems.add();round4 = triangleGroup1.pathItems.add();round1=triangleGroup1.pathItems.ellipse( LeftCY+0.43, LobjX-3.68, 0.85, 0.85, false, true );round1.fillColor=app.activeDocument.swatches[Registr].color;round1.stroked = false;round2=triangleGroup1.pathItems.ellipse( LeftCY+0.43, RobjX+2.83, 0.85, 0.85, false, true );//©Klimov S.V.round2.fillColor=app.activeDocument.swatches[Registr].color;round2.stroked = false;round3=triangleGroup1.pathItems.ellipse( LobjY+3.68, LeftCX-0.43, 0.85, 0.85, false, true );round3.fillColor=app.activeDocument.swatches[Registr].color;round3.stroked = false;round4=triangleGroup1.pathItems.ellipse( RobjY-2.83, LeftCX-0.43, 0.85, 0.85, false, true );round4.fillColor=app.activeDocument.swatches[Registr].color;round4.stroked = false;newCompoundPath1 = newLayer.compoundPathItems.add();newCompoundPath2 = newLayer.compoundPathItems.add();newCompoundPath3 = newLayer.compoundPathItems.add();newCompoundPath4 = newLayer.compoundPathItems.add();var triangleGroup = newLayer.groupItems.add();newCompoundPath1 = triangleGroup.compoundPathItems.add();newCompoundPath2 = triangleGroup.compoundPathItems.add();newCompoundPath3 = triangleGroup.compoundPathItems.add();newCompoundPath4 = triangleGroup.compoundPathItems.add();newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+14.174, LobjY+14.174), Array(RobjX, LobjY+14.174) ) );newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+14.174, LobjY+14.174), Array(RobjX+14.174, LobjY) ) );newPath1.stroked = true;newPath1.strokeWidth = 0.57;newPath1.strokeColor = app.activeDocument.swatches[Registr].color;newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-14.174, LobjY+14.174), Array(LobjX, LobjY+14.174) ) );newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-14.174, LobjY+14.174), Array(LobjX-14.174, LobjY) ) );newPath2.stroked = true;newPath2.strokeWidth = 0.57;newPath2.strokeColor = app.activeDocument.swatches[Registr].color;newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-14.174, RobjY-14.174), Array(LobjX, RobjY-14.174) ) );newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-14.174, RobjY-14.174), Array(LobjX-14.174, RobjY) ) );newPath3.stroked = true;newPath3.strokeWidth = 0.57;newPath3.strokeColor = app.activeDocument.swatches[Registr].color;newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+14.174, RobjY-14.174), Array(RobjX, RobjY-14.174) ) );newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+14.174, RobjY-14.174), Array(RobjX+14.174, RobjY) ) );newPath4.stroked = true;newPath4.strokeWidth = 0.57;newPath4.strokeColor = app.activeDocument.swatches[Registr].color;}