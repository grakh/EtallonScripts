sel=activeDocument.selection;if (sel.length < 1) {alert("No select oject")} else{newLayer=activeDocument.layers;newLayer = activeDocument.layers.add();newLayer.zOrder(ZOrderMethod.BRINGTOFRONT);newLayer.name="Crop";for (i=0; i<app.activeDocument.swatches.length; i++) {    if (app.activeDocument.swatches[i].name == '[Ñîâìåùåíèå]' | app.activeDocument.swatches[i].name == '[Registration]') Registr = app.activeDocument.swatches[i].name;};LobjX=sel[0].position[0];LobjY=sel[0].position[1];RobjX=sel[0].position[0]+sel[0].width;RobjY=sel[0].position[1]-sel[0].height;for (i=1; i<sel.length; i++){if (LobjX>sel[i].position[0]) LobjX=sel[i].position[0];if (LobjY<sel[i].position[1]) LobjY=sel[i].position[1];if (RobjX<sel[i].position[0]+sel[i].width) RobjX=sel[i].position[0]+sel[i].width;if (RobjY>sel[i].position[1]-sel[i].height) RobjY=sel[i].position[1]-sel[i].height;}//alert(""+i);LeftCY=(LobjY+RobjY)/2;LeftCX=(LobjX+RobjX)/2;//alert(""+LeftCY);newCrestPath1 = newLayer.compoundPathItems.add();newCrestPath2 = newLayer.compoundPathItems.add();newCrestPath3 = newLayer.compoundPathItems.add();newCrestPath4 = newLayer.compoundPathItems.add();var triangleGroup1 = newLayer.groupItems.add();newCrestPath1 = triangleGroup1.compoundPathItems.add();newCrestPath2 = triangleGroup1.compoundPathItems.add();newCrestPath3 = triangleGroup1.compoundPathItems.add();newCrestPath4 = triangleGroup1.compoundPathItems.add();//©Klimov S.V.newCrest1 = newCrestPath1.pathItems.add();newCrest1.setEntirePath( Array( Array(LobjX-14.174, LeftCY), Array(LobjX-28.348, LeftCY) ) );newCrest1 = newCrestPath1.pathItems.add();newCrest1.setEntirePath( Array( Array(LobjX-21.261, LeftCY-7.087), Array(LobjX-21.261, LeftCY+7.087) ) );newCrest1.stroked = true;newCrest1.strokeWidth = 0.57;newCrest1.strokeColor = app.activeDocument.swatches[Registr].color;newCrest2 = newCrestPath2.pathItems.add();newCrest2.setEntirePath( Array( Array(RobjX+14.174, LeftCY), Array(RobjX+28.348, LeftCY) ) );newCrest2 = newCrestPath2.pathItems.add();newCrest2.setEntirePath( Array( Array(RobjX+21.261, LeftCY-7.087), Array(RobjX+21.261, LeftCY+7.087) ) );newCrest2.stroked = true;newCrest2.strokeWidth = 0.57;newCrest2.strokeColor = app.activeDocument.swatches[Registr].color;newCrest3 = newCrestPath3.pathItems.add();newCrest3.setEntirePath( Array( Array(LeftCX-7.087, LobjY+21.261), Array(LeftCX+7.087, LobjY+21.261) ) );newCrest3 = newCrestPath3.pathItems.add();newCrest3.setEntirePath( Array( Array(LeftCX, LobjY+14.174), Array(LeftCX, LobjY+28.348) ) );newCrest3.stroked = true;newCrest3.strokeWidth = 0.57;newCrest3.strokeColor = app.activeDocument.swatches[Registr].color;newCrest4 = newCrestPath4.pathItems.add();newCrest4.setEntirePath( Array( Array(LeftCX-7.087, RobjY-21.261), Array(LeftCX+7.087, RobjY-21.261) ) );newCrest4 = newCrestPath4.pathItems.add();newCrest4.setEntirePath( Array( Array(LeftCX, RobjY-14.174), Array(LeftCX, RobjY-28.348) ) );newCrest4.stroked = true;newCrest4.strokeWidth = 0.57;newCrest4.strokeColor = app.activeDocument.swatches[Registr].color;//newCompoundPath1 = newLayer.compoundPathItems.add();newCompoundPath2 = newLayer.compoundPathItems.add();newCompoundPath3 = newLayer.compoundPathItems.add();newCompoundPath4 = newLayer.compoundPathItems.add();var triangleGroup = newLayer.groupItems.add();newCompoundPath1 = triangleGroup.compoundPathItems.add();newCompoundPath2 = triangleGroup.compoundPathItems.add();newCompoundPath3 = triangleGroup.compoundPathItems.add();newCompoundPath4 = triangleGroup.compoundPathItems.add();newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+42.522, LobjY+42.522), Array(RobjX+28.34, LobjY+42.522) ) );newPath1 = newCompoundPath1.pathItems.add();newPath1.setEntirePath( Array( Array(RobjX+42.522, LobjY+42.522), Array(RobjX+42.522, LobjY+28.34) ) );newPath1.stroked = true;newPath1.strokeWidth = 0.57;newPath1.strokeColor = app.activeDocument.swatches[Registr].color;newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-42.522, LobjY+42.522), Array(LobjX-28.34, LobjY+42.522) ) );newPath2 = newCompoundPath2.pathItems.add();newPath2.setEntirePath( Array( Array(LobjX-42.522, LobjY+42.522), Array(LobjX-42.522, LobjY+28.34) ) );newPath2.stroked = true;newPath2.strokeWidth = 0.57;newPath2.strokeColor = app.activeDocument.swatches[Registr].color;newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-42.522, RobjY-42.522), Array(LobjX-28.34, RobjY-42.522) ) );newPath3 = newCompoundPath3.pathItems.add();newPath3.setEntirePath( Array( Array(LobjX-42.522, RobjY-42.522), Array(LobjX-42.522, RobjY-28.34) ) );newPath3.stroked = true;newPath3.strokeWidth = 0.57;newPath3.strokeColor = app.activeDocument.swatches[Registr].color;newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+42.522, RobjY-42.522), Array(RobjX+28.34, RobjY-42.522) ) );newPath4 = newCompoundPath4.pathItems.add();newPath4.setEntirePath( Array( Array(RobjX+42.522, RobjY-42.522), Array(RobjX+42.522, RobjY-28.34) ) );newPath4.stroked = true;newPath4.strokeWidth = 0.57;newPath4.strokeColor = app.activeDocument.swatches[Registr].color;}